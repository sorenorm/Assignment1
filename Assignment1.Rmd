---
title: "Portfolio 1 - Experimental Methods 1 2019"
author: "SÃ¸ren Orm Hansen"
date: "9/22/2019"
output: html_document
---

```{r setup}
knitr::opts_chunk$set(echo = TRUE, include = TRUE)

library(pacman)

pacman::p_load(tidyverse, data.table, lme4, car, ggplot2, pastecs, psych)

```


## Portfolio exam - Part 1

#### Write a short data mining report on the CogSci Intro Week Personality Test Data in which you answer the following questions in prose, code and graphs:

First of all, you have to import the personality data. If the dataset is in your working directory, then you can just load it into R. Otherwise you will have to change your working directory.

```{r load_data}
df <- read.table("PTD.txt", header = TRUE, sep = ",")

```

Once you are done loading the data, you can start working on the questions below.

#### Question 1

Who can hold their breath longer on average, those with right or left ocular dominance? Plot the data using ggplot2 to find out. The plots should include error bars (depicting the standard error of the means). Then use the mean() and sd() functions to find mean and standard deviation of the two eye dominance groups.


```{r question1}
#Since we are only interested in people with either right or left ocular dominance, I will start by filtering the data, so I only have people with right or left ocular dominance.

filter_ocular_dom <- filter(df, ocular_dom == "Right" | ocular_dom == "Left")


ggplot(filter_ocular_dom, aes(x=ocular_dom, y=breath_hold, fill = ocular_dom)) +
  geom_bar(stat='summary', fun.y = mean, width = 0.5) +
  geom_errorbar(stat = 'summary', fun.data = mean_se, width = 0.2) +
  labs(x = "Ocular Dominance", y = "Average Breath Hold") +
  theme_minimal() + scale_fill_brewer( palette = "Blues")


summary_breath_byod <- filter_ocular_dom %>% 
  group_by(ocular_dom) %>% 
  summarise(mean(breath_hold), sd(breath_hold),Count=n())
summary_breath_byod
```

Explain your results in plain terms here: 

It seems as though people with right eye dominance are better at holding their breath on average, and people who do not have a prefered eye seem to be the worst on average at holding their breath. But the standard diviation tells us, that this prediction doesn't hold ground #needs to be changed

---

#### Question 2

Who likes silence vs. noise best? Males or females? Also in this case you should plot the data using ggplot2 (including error bars), then use the mean() and sd() functions to find mean and standard deviation of the two genders.

```{r question2}
ggplot(df, aes(x=gender, y=sound_level_pref, fill = gender)) +
  geom_bar(stat='summary', fun.y = mean, width = 0.5) +
  geom_errorbar(stat = 'summary', fun.data = mean_se, width = 0.2) +
  labs(x = "Gender", y = "Sound Level Prefered")

summary_soundlvl_bygender <- df %>% 
  group_by(gender) %>% 
  summarise(mean(sound_level_pref), sd(sound_level_pref),Count=n())
summary_soundlvl_bygender
```

Explain your results in plain terms here: 

This data might be the most insignificant I have ever seen. On average male participants seem to prefer a sound level about 1.3 'sound level points' above female participants, this is said whith a standard diviation of more that half of the mean... soooo insignificant

---

#### Question 3

Are the breath_hold data normally distributed? Provide visual and numeric support for your answer.

```{r question3}
ggplot(df, aes (x=breath_hold) ) + 
  geom_histogram(aes(y=..density..), color = "darkblue", fill = "lightblue", binwidth = 5) +
  stat_function(fun = dnorm, args = list(mean = mean(df$breath_hold, na.rm = TRUE), sd = sd(df$breath_hold, na.rm = TRUE)), colour = "black", size = 1)

#do we use describe() or stat.desc()?

describe(df$breath_hold)

round(stat.desc(df$breath_hold, basic = F, norm = T), digits = 3)

qplot(sample=df$breath_hold,stat="qq")
```


Explain your results in plain terms here: 

For the data to be normally distributed () the kurtosis (the spikiness) and the skew (if the graph is 'leaning' to one side or the other or not leaning at all) would have to have a value of 0. In this instance I found the value of spikiness to be -0.36 and the value of leaniness to be 0.58. These two values are actually not far from a normal distribution, so I would say that the data is normally distrubuted.

---

#### Question 4

Are the Balloon reaction time data (balloon and balloon_balance) normally distributed? Provide visual and numeric support for your answer.

```{r question4}
ggplot(df, aes(x=balloon)) +
  geom_histogram(aes(y=..density..), color="darkblue", fill="lightblue", binwidth = 5)+
  stat_function(fun = dnorm, args = list(mean = mean(df$balloon, na.rm = TRUE), sd = sd(df$balloon, na.rm = TRUE)), colour = "black", size = 1)

describe(df$balloon)

round(stat.desc(df$balloon, basic = F, norm = T), digits = 3)

qplot(sample=df$balloon,stat="qq")
```


Explain your results in plain terms here: 

---

#### Question 5

Shoe size could tell us something about general body size, which could also be connected to one's ability to hold your breath. In other words we predict that there is a positive relation between shoe size and how long time CogSci students can hold their breath. Try plotting the two sets of data against each other using a scatter plot (hint: both variables are continuous variables). Bonus question: Males and females have different body sizes. Use grouping in your plot to distinguish the relationship between shoe size and holding breath for males and females.

```{r question5}
ggplot(df, aes(x=breath_hold, y=shoesize))+
  geom_point(size=2) + 
  geom_smooth(method=lm)


```

```{r question5_bonus}
groupedby_gender <- group_by(df, gender)


ggplot(groupedby_gender, aes(x=breath_hold, y=shoesize, color=gender)) +
  geom_point(size=2) +
  geom_smooth(method=lm, aes(fill=gender))


```


Explain your results in plain terms here: 




