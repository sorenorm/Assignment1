---
title: "Portfolio 1 - Experimental Methods 1 2019"
author: "SÃ¸ren Orm Hansen"
date: "9/22/2019"
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, include = TRUE)

library(pacman)

pacman::p_load(tidyverse, data.table, lme4, car, ggplot2, pastecs, psych, plotrix)

```


## Portfolio exam - Part 1

#### Write a short data mining report on the CogSci Intro Week Personality Test Data in which you answer the following questions in prose, code and graphs:

First of all, you have to import the personality data. If the dataset is in your working directory, then you can just load it into R. Otherwise you will have to change your working directory.

```{r load_data}
df <- read.table("PTD.txt", header = TRUE, sep = ",")

```

Once you are done loading the data, you can start working on the questions below.

#### Question 1

Who can hold their breath longer on average, those with right or left ocular dominance? Plot the data using ggplot2 to find out. The plots should include error bars (depicting the standard error of the means). Then use the mean() and sd() functions to find mean and standard deviation of the two eye dominance groups.


```{r question1}
#Since we are only interested in people with either right or left ocular dominance, I will start by filtering the data, so I only have people with right or left ocular dominance.

filter_ocular_dom <- filter(df, ocular_dom != "Both")

#barplot with SEM-errorbars - average breath hold by ocular dominance

ggplot(filter_ocular_dom,
       aes(x = ocular_dom, y = breath_hold, fill = ocular_dom)) +
  geom_bar(
    stat = 'summary',
    fun.y = mean,
    width = 0.5,
    color = "Black"
  ) +
  stat_summary(
    fun.data = mean_cl_normal,
    geom = "errorbar",
    color = "Black",
    width = 0.1
  ) +
  theme_minimal() + 
  scale_fill_brewer(palette = "Blues") +  
  labs(title = "Barplot of average breath hold by ocular dominance", 
       x = "Ocular Dominance", 
       y = "Average Breath Hold"
  )

#finding the mean, standard deviation, the 95% confidence interval, and the numbers of observations in each category

summary_breath_byod <- filter_ocular_dom %>%
  group_by(ocular_dom) %>%
  summarise(
    mean(breath_hold),
    sd(breath_hold),
    sem_max = mean(breath_hold) + std.error(breath_hold)*1.96,
    sem_min = mean(breath_hold) - std.error(breath_hold)*1.96,
    Count = n()
  )
summary_breath_byod
```

Explain your results in plain terms here: 

Our data tells us, that people with right ocular dominance in our sample can hold their breath longer on average (57.7 seconds) than people in our sample with left ocular dominance (53.4 seconds). 

To know how certain we are of the two averages we've found, we look at the 95% confidence or the interval in which we are 95% certain that the true average of the population is. In the table I have provided the maximum (sem_max) and minimum (sem_min) values for the 95% confidence interval for both right and left ocular dominance. We see that these two intervals overlap. This indicates, that the difference between the two averages is not statistically significant - that the difference is likely to just have occured by chance.

The two bars in the graph indicate the means of the two groups and the 'capital I's' on top of the bars indicate the 95% confidence intervals. Here we see the difference in the two means and the overlapping 95% confidence intervals.

Thus, we cannot conclude from the data in our sample whether people with right eye or left eye dominance can hold their breath longer


#We can also see the standard diviation - the standard diviation is found column called "sd(breath_hold)" and it tells us something about the variance in the data - the standard diviation is very big.

#Do we use the z or t test when the sample size is 21?

---

#### Question 2

Who likes silence vs. noise best? Males or females? Also in this case you should plot the data using ggplot2 (including error bars), then use the mean() and sd() functions to find mean and standard deviation of the two genders.

```{r question2}
#boxplot with mean and errorbars - prefered sound level by gender

ggplot(df, aes(x = gender, y = sound_level_pref, fill = gender)) +
  geom_boxplot(width = 0.5) + stat_summary(
    fun.y = mean,
    geom = "point",
    shape = 23,
    colour = "Black"
  ) + 
  stat_summary(
    fun.data = mean_cl_normal,
    geom = "errorbar",
    colour = "Black",
    width = 0.1
  ) +
  labs(title = "Boxplot of prefered sound level by gender", 
       y = "Prefered Sound Level (0-100)", 
       x = "Gender"
  ) + 
  theme_minimal() +
  scale_fill_brewer(palette = "Blues") 


#finding the mean, standard deviation, the 95% confidence interval, and the numbers of observations in each category

summary_soundlvl_bygender <- df %>%
  group_by(gender) %>%
  summarise(
    mean(sound_level_pref),
    sd(sound_level_pref),
    sem_max = mean(sound_level_pref) + std.error(sound_level_pref)*1.96,
    sem_min = mean(sound_level_pref) - std.error(sound_level_pref)*1.96,
    Count = n()
  )
summary_soundlvl_bygender
```

Explain your results in plain terms here: 

Our data tells us, that the males in our sample prefer a louder sound level (a sound level of 25.6 on a scale of 0 to 100) than females in our sample (a sound level of 24.3 on a scale of 0 to 100) on average. 

To know how certain we are of the two averages we've found, we look at the 95% confidence or the interval in which we are 95% certain that the true average of the population is. In the table I have provided the maximum (sem_max) and minimum (sem_min) values for the 95% confidence interval for both males and females. We see that the 95% confidence interval of males incapsulate the 95% confidence interval for females. This indicates, that the difference between the two averages is not statistically significant - that the difference is likely to just have occured by chance.

The two bars in the graph indicate the means of the two groups and the 'capital I's' on top of the bars indicate the 95% confidence intervals. Here we see the difference in the two means and the 95% confidence intervals of female that incapsulates the 95% confidence interval for males.

Thus, we cannot conclude from the data in our sample whether males or females prefer a louder sound level.

---

#### Question 3

Are the breath_hold data normally distributed? Provide visual and numeric support for your answer.

```{r question3}
#density plot - breath hold data

ggplot(df, aes (x = breath_hold)) +
  geom_histogram(
    aes(y = ..density..),
    color = "darkblue",
    fill = "lightblue",
    binwidth = 3
  ) +
  stat_function(
    fun = dnorm,
    args = list(
      mean = mean(df$breath_hold, na.rm = TRUE),
      sd = sd(df$breath_hold, na.rm = TRUE)
    ),
    colour = "black",
    size = 1
  ) +
  labs(title = "Density plot of breath_hold data", 
       y = "Density", 
       x = "Breath hold (sec)"
  ) + 
  theme_minimal()

#QQ plot of breath hold data
  
ggplot(df, aes(sample = breath_hold)) + 
  stat_qq() + 
  stat_qq_line() +
  labs(title = "QQ plot of breath hold data", 
       y = "Observed value", 
       x = "Expected value"
  ) + 
  theme_minimal()


round(stat.desc(df$breath_hold, basic = F, norm = T), digits = 2)
```

Explain your results in plain terms here: 

To access if the breath_hold data is normally distributed, I have provided a density plot of the breath_hold with what the normal curve would look like lain on top of it, a QQ plot of the breath_hold data, and a table with describtive statistics.

Describtive statistics:
For a data set to be normally distributed a couple of numerical parameters have to aply to the set. The ones I will focus on here are: the mean (average) and the median (the value that splits the data in two equal halfs) have to be (approximately) equal, the skewness and kurtosis devided by two times the standard error (skew.2SE) has to be within the interval from -1 to 1 preferably as close to zero as posible, and the p-value of the Shapiro-Wilk test has to be greater than 0.05.

In the breath_hold data we have found the median to be 51.91 seconds and the mean to be 55.77 seconds. This is almost

QQ-plot:
The quantile-quantile plot, or the QQ-plot, compares data colected in an experiment with the theoretically expected distribution of that data if it was normally distributed. If a data set is normally distributed the QQ-plot wil resemple a diagonal line. 

On the QQ-plot of the breath_hold data we see that the data follows the diagonal line indicating the theoretical values for a normally distributed data set. The QQ-plot of the data suggests that the breath_hold data is normally distributed.

Density plot:
On the density plot we see that the breath_hold data is slightly positively skewed, this will always be the case for time-data, because we cannot find any negative data - so zero will be a fixed lower boundry, while there is no fixed upper boundry. 

However, the black line on the density plot shows what a normally distributed data set with the same mean and standard diviation would look like. We see that the breath_hold data (the vertical bars on the density plot) roughly follows this line. This suggests that the breath_hold data is normally distributed.



For the data to be normally distributed the graph of the data should be resemble a bell - it should be symetric, not spiky, not leaning to one side or the other, and decreasing smoothly on both sides of the symetry axis. Data from the real world are never perfectly normal, but the data can be close enough to normally ditributed that we still call it normally distributed.    

the kurtosis (the spikiness) and the skew (if the graph is 'leaning' to one side or the other or not leaning at all) would have to have a value of 0. In this instance I found the value of spikiness to be -0.36 and the value of leaniness to be 0.58. These two values are actually not far from a normal distribution, so I would say that the data is normally distrubuted.

---

#### Question 4

Are the Balloon reaction time data (balloon and balloon_balance) normally distributed? Provide visual and numeric support for your answer.

```{r question4}
ggplot(df, aes(x = balloon)) +
  geom_histogram(
    aes(y = ..density..),
    color = "darkblue",
    fill = "lightblue",
    binwidth = 3
  ) +
  stat_function(
    fun = dnorm,
    args = list(
      mean = mean(df$balloon, na.rm = TRUE),
      sd = sd(df$balloon, na.rm = TRUE)
    ),
    colour = "black",
    size = 1
  ) + labs(title = "Density plot of balloon inflation data with normal line") + 
  theme_minimal()

ggplot(df, aes(x = balloon_balance)) +
  geom_histogram(
    aes(y = ..density..),
    color = "darkblue",
    fill = "lightblue",
    binwidth = 3
  ) +
  stat_function(
    fun = dnorm,
    args = list(
      mean = mean(df$balloon, na.rm = TRUE),
      sd = sd(df$balloon, na.rm = TRUE)
    ),
    colour = "black",
    size = 1
  ) + labs(title = "Density plot of balloon balance data with normal line") + 
  theme_minimal()

ggplot(df, aes(sample = balloon)) + 
  stat_qq() + 
  stat_qq_line() +
  labs(title = "QQ plot of balloon inflation data with normal line")

ggplot(df, aes(sample = balloon_balance)) + 
  stat_qq() + 
  stat_qq_line() +
  labs(title = "QQ plot of balloon balance data with normal line")

round(stat.desc(df$balloon, basic = F, norm = T), digits = 3)

round(stat.desc(df$balloon_balance, basic = F, norm = T), digits = 3)

```


Explain your results in plain terms here: 

---

#### Question 5

Shoe size could tell us something about general body size, which could also be connected to one's ability to hold your breath. In other words we predict that there is a positive relation between shoe size and how long time CogSci students can hold their breath. Try plotting the two sets of data against each other using a scatter plot (hint: both variables are continuous variables). Bonus question: Males and females have different body sizes. Use grouping in your plot to distinguish the relationship between shoe size and holding breath for males and females.

```{r question5}
ggplot(df, aes(x = breath_hold, y = shoesize)) +
  geom_point(size = 2) +
  geom_smooth(method = lm) +
  labs(title = "Scatter plot - Shoesize by breath hold")


```

```{r question5_bonus}
groupedby_gender <- group_by(df, gender)


ggplot(groupedby_gender,
       aes(x = breath_hold, y = shoesize, color = gender)) +
  geom_point(size = 2) +
  geom_smooth(method = lm, aes(fill = gender)) +
  labs(title = "Scatter plot - Shoesize by breath hold seperated by gender")


```


Explain your results in plain terms here: 




